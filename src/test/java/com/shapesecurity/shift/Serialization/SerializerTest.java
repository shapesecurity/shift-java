package com.shapesecurity.shift.serialization;

import com.shapesecurity.shift.ast.Node;
import com.shapesecurity.shift.fuzzer.Fuzzer;
import org.junit.Test;

import java.util.Random;

import static org.junit.Assert.assertEquals;

public class SerializerTest {
    @Test
    public void testSerializerRandom5() {
        Node randomAST0 = Fuzzer.generate(new Random(0), 5);
        String serialization0 = Serializer.serialize(randomAST0);
        assertEquals("{\"type\":\"Script\",\"directives\":[{\"type\":\"Directive\",\"rawValue\":\"H2$6jpsgvhR$_G_\"},{\"type\":\"Directive\",\"rawValue\":\"ZKWtowL\"},{\"type\":\"Directive\",\"rawValue\":\"lMr\"}],\"statements\":[]}", serialization0);

        Node randomAST1 = Fuzzer.generate(new Random(1), 5);
        String serialization1 = Serializer.serialize(randomAST1);
        assertEquals("{\"type\":\"Module\",\"directives\":[{\"type\":\"Directive\",\"rawValue\":\"uqvE1fGVJOaiUwL\"},{\"type\":\"Directive\",\"rawValue\":\"iR_h7i6H645Dx4\"},{\"type\":\"Directive\",\"rawValue\":\"rlat\"}],\"items\":[]}", serialization1);

        Node randomAST2 = Fuzzer.generate(new Random(2), 5);
        String serialization2 = Serializer.serialize(randomAST2);
        assertEquals("{\"type\":\"Module\",\"directives\":[{\"type\":\"Directive\",\"rawValue\":\"sFcZT\"},{\"type\":\"Directive\",\"rawValue\":\"KD09a059\"}],\"items\":[{\"type\":\"VariableDeclarationStatement\",\"declaration\":{\"type\":\"VariableDeclaration\",\"kind\":\"const\",\"declarators\":[{\"type\":\"VariableDeclarator\",\"binding\":{\"type\":\"BindingIdentifier\",\"name\":\"Ai0mKHoI3xaL\"},\"init\":{\"type\":\"NewExpression\",\"callee\":{\"type\":\"LiteralStringExpression\",\"value\":\"vzNuDO5\"},\"arguments\":[]}},{\"type\":\"VariableDeclarator\",\"binding\":{\"type\":\"BindingIdentifier\",\"name\":\"oj\"},\"init\":{\"type\":\"StaticMemberExpression\",\"property\":\"AHk$DJx89HFo8\",\"object\":{\"type\":\"Super\"}}},{\"type\":\"VariableDeclarator\",\"binding\":{\"type\":\"BindingIdentifier\",\"name\":\"R3\"},\"init\":{\"type\":\"UnaryExpression\",\"operator\":\"!\",\"operand\":{\"type\":\"LiteralStringExpression\",\"value\":\"xT\"}}},{\"type\":\"VariableDeclarator\",\"binding\":{\"type\":\"BindingIdentifier\",\"name\":\"F6L6j_e4JE\"},\"init\":{\"type\":\"LiteralStringExpression\",\"value\":\"ieFs3U2xrIv7yaT\"}}]}},{\"type\":\"Import\",\"defaultBinding\":{\"type\":\"BindingIdentifier\",\"name\":\"oG\"},\"namedImports\":[{\"type\":\"ImportSpecifier\",\"name\":\"lG9_M\",\"binding\":{\"type\":\"BindingIdentifier\",\"name\":\"FvIM\"}},{\"type\":\"ImportSpecifier\",\"name\":\"M4XOtN\",\"binding\":{\"type\":\"BindingIdentifier\",\"name\":\"YS\"}},{\"type\":\"ImportSpecifier\",\"name\":\"null\",\"binding\":{\"type\":\"BindingIdentifier\",\"name\":\"j3naX\"}},{\"type\":\"ImportSpecifier\",\"name\":\"WiSiUjBIXemip\",\"binding\":{\"type\":\"BindingIdentifier\",\"name\":\"lFk$rHLK\"}}],\"moduleSpecifier\":\"BaDv44qzTTp8\"},{\"type\":\"Export\",\"declaration\":{\"type\":\"FunctionDeclaration\",\"name\":{\"type\":\"BindingIdentifier\",\"name\":\"XwoWWo\"},\"isGenerator\":false,\"params\":{\"type\":\"FormalParameters\",\"items\":[],\"rest\":null},\"body\":{\"type\":\"FunctionBody\",\"directives\":[],\"statements\":[]}}},{\"type\":\"ClassDeclaration\",\"name\":{\"type\":\"BindingIdentifier\",\"name\":\"_QW0wbpy6uF9P\"},\"super\":null,\"elements\":[{\"type\":\"ClassElement\",\"isStatic\":\"false\",\"method\":{\"type\":\"Setter\",\"param\":{\"type\":\"ObjectBinding\",\"properties\":[]},\"body\":{\"type\":\"FunctionBody\",\"directives\":[],\"statements\":[]},\"name\":{\"type\":\"ComputedPropertyName\",\"expression\":{\"type\":\"LiteralStringExpression\",\"value\":\"xpXHamgh8btg\"}}}},{\"type\":\"ClassElement\",\"isStatic\":\"false\",\"method\":{\"type\":\"Method\",\"isGenerator\":false,\"params\":{\"type\":\"FormalParameters\",\"items\":[],\"rest\":null},\"body\":{\"type\":\"FunctionBody\",\"directives\":[],\"statements\":[]},\"name\":{\"type\":\"StaticPropertyName\",\"value\":\"MfYe\"}}},{\"type\":\"ClassElement\",\"isStatic\":\"false\",\"method\":{\"type\":\"Setter\",\"param\":{\"type\":\"BindingIdentifier\",\"name\":\"HL\"},\"body\":{\"type\":\"FunctionBody\",\"directives\":[],\"statements\":[]},\"name\":{\"type\":\"StaticPropertyName\",\"value\":\"pnSZ_\"}}},{\"type\":\"ClassElement\",\"isStatic\":\"false\",\"method\":{\"type\":\"Getter\",\"body\":{\"type\":\"FunctionBody\",\"directives\":[],\"statements\":[]},\"name\":{\"type\":\"ComputedPropertyName\",\"expression\":{\"type\":\"LiteralStringExpression\",\"value\":\"PJi0JmnhO\"}}}}]}]}", serialization2);

        Node randomAST3 = Fuzzer.generate(new Random(3), 5);
        String serialization3 = Serializer.serialize(randomAST3);
        assertEquals("{\"type\":\"Script\",\"directives\":[],\"statements\":[]}", serialization3);

        Node randomAST4 = Fuzzer.generate(new Random(4), 5);
        String serialization4 = Serializer.serialize(randomAST4);
        assertEquals("{\"type\":\"Script\",\"directives\":[{\"type\":\"Directive\",\"rawValue\":\"UyUR_GTv\"},{\"type\":\"Directive\",\"rawValue\":\"L4lPqdD$0QXXph\"}],\"statements\":[{\"type\":\"BlockStatement\",\"block\":{\"type\":\"Block\",\"statements\":[]}},{\"type\":\"BlockStatement\",\"block\":{\"type\":\"Block\",\"statements\":[]}},{\"type\":\"EmptyStatement\"}]}", serialization4);

        Node randomAST5 = Fuzzer.generate(new Random(5), 5);
        String serialization5 = Serializer.serialize(randomAST5);
        assertEquals("{\"type\":\"Module\",\"directives\":[{\"type\":\"Directive\",\"rawValue\":\"B2sms2$AsxO9O\"},{\"type\":\"Directive\",\"rawValue\":\"gD6BYAzQUpuUZmB\"}],\"items\":[{\"type\":\"ExportAllFrom\",\"moduleSpecifier\":\"IcHatPZACuSr\"},{\"type\":\"ExportAllFrom\",\"moduleSpecifier\":\"gb\"}]}", serialization5);
    }

    @Test
    public void testSerializerRandom10() {
        Node randomAST = Fuzzer.generate(new Random(0), 10);
        String serialization = Serializer.serialize(randomAST);
        assertEquals("{\"type\":\"Script\",\"directives\":[{\"type\":\"Directive\",\"rawValue\":\"H2$6jpsgvhR$_G_\"},{\"type\":\"Directive\",\"rawValue\":\"ZKWtowL\"},{\"type\":\"Directive\",\"rawValue\":\"lMr\"}],\"statements\":[]}", serialization);

        Node randomAST1 = Fuzzer.generate(new Random(1), 10);
        String serialization1 = Serializer.serialize(randomAST1);
        assertEquals("{\"type\":\"Module\",\"directives\":[{\"type\":\"Directive\",\"rawValue\":\"uqvE1fGVJOaiUwL\"},{\"type\":\"Directive\",\"rawValue\":\"iR_h7i6H645Dx4\"},{\"type\":\"Directive\",\"rawValue\":\"rlat\"}],\"items\":[]}", serialization1);

        Node randomAST2 = Fuzzer.generate(new Random(2), 10);
        String serialization2 = Serializer.serialize(randomAST2);
        assertEquals("{\"type\":\"Module\",\"directives\":[{\"type\":\"Directive\",\"rawValue\":\"sFcZT\"},{\"type\":\"Directive\",\"rawValue\":\"KD09a059\"}],\"items\":[{\"type\":\"ExportDefault\",\"body\":{\"type\":\"FunctionDeclaration\",\"name\":{\"type\":\"BindingIdentifier\",\"name\":\"r\"},\"isGenerator\":true,\"params\":{\"type\":\"FormalParameters\",\"items\":[{\"type\":\"ObjectBinding\",\"properties\":[{\"type\":\"BindingPropertyProperty\",\"name\":{\"type\":\"StaticPropertyName\",\"value\":\"jsq\"},\"binding\":{\"type\":\"BindingWithDefault\",\"binding\":{\"type\":\"ArrayBinding\",\"elements\":[],\"restElement\":null},\"init\":{\"type\":\"AssignmentExpression\",\"binding\":{\"type\":\"ObjectBinding\",\"properties\":[]},\"expression\":{\"type\":\"NewExpression\",\"callee\":{\"type\":\"LiteralStringExpression\",\"value\":\"hTkrgJSiLy\"},\"arguments\":[]}}}}]}],\"rest\":null},\"body\":{\"type\":\"FunctionBody\",\"directives\":[],\"statements\":[{\"type\":\"WithStatement\",\"object\":{\"type\":\"IdentifierExpression\",\"name\":\"eval\"},\"body\":{\"type\":\"VariableDeclarationStatement\",\"declaration\":{\"type\":\"VariableDeclaration\",\"kind\":\"let\",\"declarators\":[{\"type\":\"VariableDeclarator\",\"binding\":{\"type\":\"BindingIdentifier\",\"name\":\"RrmhnE\"},\"init\":null},{\"type\":\"VariableDeclarator\",\"binding\":{\"type\":\"BindingIdentifier\",\"name\":\"lnwk\"},\"init\":null},{\"type\":\"VariableDeclarator\",\"binding\":{\"type\":\"ObjectBinding\",\"properties\":[]},\"init\":{\"type\":\"CallExpression\",\"callee\":{\"type\":\"LiteralStringExpression\",\"value\":\"jALdB7D_g8cZA\"},\"arguments\":[]}},{\"type\":\"VariableDeclarator\",\"binding\":{\"type\":\"BindingIdentifier\",\"name\":\"GSR\"},\"init\":null}]}}},{\"type\":\"TryFinallyStatement\",\"body\":{\"type\":\"Block\",\"statements\":[{\"type\":\"TryFinallyStatement\",\"body\":{\"type\":\"Block\",\"statements\":[]},\"catchClause\":null,\"finalizer\":{\"type\":\"Block\",\"statements\":[]}},{\"type\":\"ContinueStatement\",\"label\":\"null\"},{\"type\":\"TryCatchStatement\",\"body\":{\"type\":\"Block\",\"statements\":[]},\"catchClause\":{\"type\":\"CatchClause\",\"binding\":{\"type\":\"ObjectBinding\",\"properties\":[]},\"body\":{\"type\":\"Block\",\"statements\":[]}}},{\"type\":\"LabeledStatement\",\"label\":\"arguments\",\"body\":{\"type\":\"DoWhileStatement\",\"test\":{\"type\":\"LiteralRegexExpression\",\"pattern\":\"/cpHn88hjbN/\",\"flags\":\"\"},\"body\":{\"type\":\"BreakStatement\",\"label\":\"null\"}}}]},\"catchClause\":{\"type\":\"CatchClause\",\"binding\":{\"type\":\"ArrayBinding\",\"elements\":[{\"type\":\"BindingWithDefault\",\"binding\":{\"type\":\"BindingIdentifier\",\"name\":\"p$Fq2Rjqv\"},\"init\":{\"type\":\"TemplateExpression\",\"tag\":null,\"elements\":[{\"type\":\"TemplateElement\",\"rawValue\":\"Tnj7h6\"},{\"type\":\"LiteralStringExpression\",\"value\":\"MdJ2\"},{\"type\":\"TemplateElement\",\"rawValue\":\"bDUo9fmN\"}]}}],\"restElement\":null},\"body\":{\"type\":\"Block\",\"statements\":[{\"type\":\"BlockStatement\",\"block\":{\"type\":\"Block\",\"statements\":[]}},{\"type\":\"TryCatchStatement\",\"body\":{\"type\":\"Block\",\"statements\":[]},\"catchClause\":{\"type\":\"CatchClause\",\"binding\":{\"type\":\"BindingIdentifier\",\"name\":\"CgT\"},\"body\":{\"type\":\"Block\",\"statements\":[]}}}]}},\"finalizer\":{\"type\":\"Block\",\"statements\":[{\"type\":\"LabeledStatement\",\"label\":\"kGuFJ08\",\"body\":{\"type\":\"DebuggerStatement\"}},{\"type\":\"TryFinallyStatement\",\"body\":{\"type\":\"Block\",\"statements\":[]},\"catchClause\":null,\"finalizer\":{\"type\":\"Block\",\"statements\":[]}},{\"type\":\"LabeledStatement\",\"label\":\"arguments\",\"body\":{\"type\":\"SwitchStatementWithDefault\",\"discriminant\":{\"type\":\"LiteralStringExpression\",\"value\":\"Ma\"},\"preDefaultCases\":[],\"defaultCase\":{\"type\":\"SwitchDefault\",\"consequent\":[]},\"postDefaultCases\":[]}},{\"type\":\"ForInStatement\",\"left\":{\"type\":\"BindingIdentifier\",\"name\":\"aG\"},\"right\":{\"type\":\"NewTargetExpression\"},\"body\":{\"type\":\"DebuggerStatement\"}}]}},{\"type\":\"VariableDeclarationStatement\",\"declaration\":{\"type\":\"VariableDeclaration\",\"kind\":\"const\",\"declarators\":[{\"type\":\"VariableDeclarator\",\"binding\":{\"type\":\"BindingIdentifier\",\"name\":\"q9SXgL3hHK3AV\"},\"init\":{\"type\":\"FunctionExpression\",\"name\":null,\"isGenerator\":false,\"params\":{\"type\":\"FormalParameters\",\"items\":[],\"rest\":null},\"body\":{\"type\":\"FunctionBody\",\"directives\":[],\"statements\":[]}}},{\"type\":\"VariableDeclarator\",\"binding\":{\"type\":\"ObjectBinding\",\"properties\":[]},\"init\":{\"type\":\"ComputedMemberExpression\",\"expression\":{\"type\":\"LiteralStringExpression\",\"value\":\"aSzczCB9kJJpfqq\"},\"object\":{\"type\":\"LiteralStringExpression\",\"value\":\"gwcDzcarEt5\"}}}]}},{\"type\":\"ForInStatement\",\"left\":{\"type\":\"BindingIdentifier\",\"name\":\"AkuOrExlQMHLJn8\"},\"right\":{\"type\":\"TemplateExpression\",\"tag\":null,\"elements\":[{\"type\":\"TemplateElement\",\"rawValue\":\"BkJCzG4s5Br\"},{\"type\":\"LiteralNullExpression\"},{\"type\":\"TemplateElement\",\"rawValue\":\"LK$M6gpNympuK\"}]},\"body\":{\"type\":\"ExpressionStatement\",\"expression\":{\"type\":\"CompoundAssignmentExpression\",\"operator\":\"^=\",\"binding\":{\"type\":\"ComputedMemberExpression\",\"expression\":{\"type\":\"LiteralStringExpression\",\"value\":\"M\"},\"object\":{\"type\":\"LiteralStringExpression\",\"value\":\"ow_xbYP\"}},\"expression\":{\"type\":\"LiteralStringExpression\",\"value\":\"x\"}}}}]}}},{\"type\":\"ExportFrom\",\"namedExports\":[{\"type\":\"ExportSpecifier\",\"name\":\"shu9ab6qcOQisF2\",\"exportedName\":\"WM1Elp2XgTbY\"},{\"type\":\"ExportSpecifier\",\"name\":\"wJwSsm\",\"exportedName\":\"SxGWsRqKZW\"},{\"type\":\"ExportSpecifier\",\"name\":\"null\",\"exportedName\":\"xIFPlpNjmq\"}],\"moduleSpecifier\":\"null\"},{\"type\":\"DoWhileStatement\",\"test\":{\"type\":\"AssignmentExpression\",\"binding\":{\"type\":\"ArrayBinding\",\"elements\":[null],\"restElement\":{\"type\":\"BindingIdentifier\",\"name\":\"azasuGlGrqbtJ\"}},\"expression\":{\"type\":\"ThisExpression\"}},\"body\":{\"type\":\"DebuggerStatement\"}},{\"type\":\"ClassDeclaration\",\"name\":{\"type\":\"BindingIdentifier\",\"name\":\"_QW0wbpy6uF9P\"},\"super\":null,\"elements\":[{\"type\":\"ClassElement\",\"isStatic\":\"false\",\"method\":{\"type\":\"Setter\",\"param\":{\"type\":\"ArrayBinding\",\"elements\":[{\"type\":\"BindingIdentifier\",\"name\":\"cO08N9jqmN\"},null,{\"type\":\"BindingWithDefault\",\"binding\":{\"type\":\"BindingIdentifier\",\"name\":\"kC\"},\"init\":{\"type\":\"ThisExpression\"}},{\"type\":\"BindingWithDefault\",\"binding\":{\"type\":\"StaticMemberExpression\",\"property\":\"ZaJeau\",\"object\":{\"type\":\"Super\"}},\"init\":{\"type\":\"LiteralStringExpression\",\"value\":\"rmNglrZ\"}}],\"restElement\":null},\"body\":{\"type\":\"FunctionBody\",\"directives\":[{\"type\":\"Directive\",\"rawValue\":\"UXcV1nT0j_B5\"},{\"type\":\"Directive\",\"rawValue\":\"LoPIfW80O2r\"}],\"statements\":[{\"type\":\"ThrowStatement\",\"expression\":{\"type\":\"IdentifierExpression\",\"name\":\"eval\"}},{\"type\":\"IfStatement\",\"test\":{\"type\":\"ConditionalExpression\",\"test\":{\"type\":\"FunctionExpression\",\"name\":null,\"isGenerator\":true,\"params\":{\"type\":\"FormalParameters\",\"items\":[],\"rest\":null},\"body\":{\"type\":\"FunctionBody\",\"directives\":[],\"statements\":[]}},\"consequent\":{\"type\":\"ArrayExpression\",\"elements\":[]},\"alternate\":{\"type\":\"CompoundAssignmentExpression\",\"operator\":\">>>=\",\"binding\":{\"type\":\"ComputedMemberExpression\",\"expression\":{\"type\":\"LiteralStringExpression\",\"value\":\"rIcXG4E6fpq1\"},\"object\":{\"type\":\"LiteralStringExpression\",\"value\":\"a\"}},\"expression\":{\"type\":\"LiteralStringExpression\",\"value\":\"$sW4a9u\"}}},\"consequent\":{\"type\":\"SwitchStatementWithDefault\",\"discriminant\":{\"type\":\"LiteralNumericExpression\",\"value\":0.6828347425884708},\"preDefaultCases\":[],\"defaultCase\":{\"type\":\"SwitchDefault\",\"consequent\":[]},\"postDefaultCases\":[]},\"alternate\":{\"type\":\"ForOfStatement\",\"left\":{\"type\":\"BindingIdentifier\",\"name\":\"sw6d5EfrUUK\"},\"right\":{\"type\":\"ClassExpression\",\"name\":null,\"super\":null,\"elements\":[]},\"body\":{\"type\":\"EmptyStatement\"}}}]},\"name\":{\"type\":\"ComputedPropertyName\",\"expression\":{\"type\":\"ThisExpression\"}}}},{\"type\":\"ClassElement\",\"isStatic\":\"false\",\"method\":{\"type\":\"Getter\",\"body\":{\"type\":\"FunctionBody\",\"directives\":[{\"type\":\"Directive\",\"rawValue\":\"o\"}],\"statements\":[]},\"name\":{\"type\":\"ComputedPropertyName\",\"expression\":{\"type\":\"ComputedMemberExpression\",\"expression\":{\"type\":\"ArrowExpression\",\"params\":{\"type\":\"FormalParameters\",\"items\":[],\"rest\":null},\"body\":{\"type\":\"FunctionBody\",\"directives\":[],\"statements\":[]}},\"object\":{\"type\":\"FunctionExpression\",\"name\":null,\"isGenerator\":true,\"params\":{\"type\":\"FormalParameters\",\"items\":[],\"rest\":null},\"body\":{\"type\":\"FunctionBody\",\"directives\":[],\"statements\":[]}}}}}},{\"type\":\"ClassElement\",\"isStatic\":\"false\",\"method\":{\"type\":\"Method\",\"isGenerator\":false,\"params\":{\"type\":\"FormalParameters\",\"items\":[{\"type\":\"ArrayBinding\",\"elements\":[null,null,null],\"restElement\":{\"type\":\"ArrayBinding\",\"elements\":[null,null],\"restElement\":null}},{\"type\":\"ObjectBinding\",\"properties\":[{\"type\":\"BindingPropertyProperty\",\"name\":{\"type\":\"StaticPropertyName\",\"value\":\"eUjBI\"},\"binding\":{\"type\":\"BindingWithDefault\",\"binding\":{\"type\":\"ArrayBinding\",\"elements\":[],\"restElement\":null},\"init\":{\"type\":\"ArrayExpression\",\"elements\":[]}}},{\"type\":\"BindingPropertyProperty\",\"name\":{\"type\":\"StaticPropertyName\",\"value\":\"ngh8btgHbvBxBw\"},\"binding\":{\"type\":\"BindingWithDefault\",\"binding\":{\"type\":\"ArrayBinding\",\"elements\":[],\"restElement\":null},\"init\":{\"type\":\"UnaryExpression\",\"operator\":\"typeof\",\"operand\":{\"type\":\"LiteralStringExpression\",\"value\":\"zu4SG2yz\"}}}},{\"type\":\"BindingPropertyProperty\",\"name\":{\"type\":\"StaticPropertyName\",\"value\":\"_a\"},\"binding\":{\"type\":\"BindingIdentifier\",\"name\":\"K\"}}]}],\"rest\":null},\"body\":{\"type\":\"FunctionBody\",\"directives\":[{\"type\":\"Directive\",\"rawValue\":\"$v4\"},{\"type\":\"Directive\",\"rawValue\":\"P6JvIM8j\"},{\"type\":\"Directive\",\"rawValue\":\"ztNOxSCRLG9\"},{\"type\":\"Directive\",\"rawValue\":\"DnaXBXx4\"}],\"statements\":[{\"type\":\"SwitchStatementWithDefault\",\"discriminant\":{\"type\":\"CallExpression\",\"callee\":{\"type\":\"Super\"},\"arguments\":[]},\"preDefaultCases\":[{\"type\":\"SwitchCase\",\"test\":{\"type\":\"CompoundAssignmentExpression\",\"operator\":\"+=\",\"binding\":{\"type\":\"ComputedMemberExpression\",\"expression\":{\"type\":\"LiteralStringExpression\",\"value\":\"K9HFo8e5\"},\"object\":{\"type\":\"LiteralStringExpression\",\"value\":\"Ai0mKHoI3xaL\"}},\"expression\":{\"type\":\"LiteralStringExpression\",\"value\":\"vzNuDO5\"}},\"consequent\":[{\"type\":\"LabeledStatement\",\"label\":\"UVnKfYESF7$\",\"body\":{\"type\":\"DebuggerStatement\"}},{\"type\":\"BreakStatement\",\"label\":\"null\"},{\"type\":\"LabeledStatement\",\"label\":\"Vjq9RlmsXlh_\",\"body\":{\"type\":\"WhileStatement\",\"test\":{\"type\":\"LiteralStringExpression\",\"value\":\"_\"},\"body\":{\"type\":\"DebuggerStatement\"}}}]},{\"type\":\"SwitchCase\",\"test\":{\"type\":\"LiteralBooleanExpression\",\"value\":true},\"consequent\":[{\"type\":\"ContinueStatement\",\"label\":\"null\"},{\"type\":\"BreakStatement\",\"label\":\"null\"},{\"type\":\"WithStatement\",\"object\":{\"type\":\"LiteralStringExpression\",\"value\":\"xc7\"},\"body\":{\"type\":\"DebuggerStatement\"}},{\"type\":\"ForInStatement\",\"left\":{\"type\":\"BindingIdentifier\",\"name\":\"D2xrIv7yaT0163\"},\"right\":{\"type\":\"LiteralStringExpression\",\"value\":\"XesT3XNjcWl\"},\"body\":{\"type\":\"EmptyStatement\"}}]},{\"type\":\"SwitchCase\",\"test\":{\"type\":\"LiteralInfinityExpression\"},\"consequent\":[{\"type\":\"BreakStatement\",\"label\":\"null\"},{\"type\":\"ThrowStatement\",\"expression\":{\"type\":\"LiteralStringExpression\",\"value\":\"F6L6j_e4JE\"}},{\"type\":\"ContinueStatement\",\"label\":\"null\"}]}],\"defaultCase\":{\"type\":\"SwitchDefault\",\"consequent\":[{\"type\":\"ContinueStatement\",\"label\":\"null\"},{\"type\":\"VariableDeclarationStatement\",\"declaration\":{\"type\":\"VariableDeclaration\",\"kind\":\"var\",\"declarators\":[{\"type\":\"VariableDeclarator\",\"binding\":{\"type\":\"ArrayBinding\",\"elements\":[],\"restElement\":null},\"init\":{\"type\":\"LiteralStringExpression\",\"value\":\"kDczTfZ\"}}]}}]},\"postDefaultCases\":[{\"type\":\"SwitchCase\",\"test\":{\"type\":\"BinaryExpression\",\"operator\":\"instanceof\",\"left\":{\"type\":\"LiteralStringExpression\",\"value\":\"jhYsiag\"},\"right\":{\"type\":\"LiteralStringExpression\",\"value\":\"_XEkbZLNApnciep\"}},\"consequent\":[{\"type\":\"BlockStatement\",\"block\":{\"type\":\"Block\",\"statements\":[]}},{\"type\":\"ForStatement\",\"init\":null,\"test\":null,\"update\":null,\"body\":{\"type\":\"EmptyStatement\"}}]},{\"type\":\"SwitchCase\",\"test\":{\"type\":\"AssignmentExpression\",\"binding\":{\"type\":\"ArrayBinding\",\"elements\":[],\"restElement\":null},\"expression\":{\"type\":\"LiteralStringExpression\",\"value\":\"ahHYi\"}},\"consequent\":[{\"type\":\"ThrowStatement\",\"expression\":{\"type\":\"LiteralStringExpression\",\"value\":\"sdvj\"}},{\"type\":\"EmptyStatement\"}]},{\"type\":\"SwitchCase\",\"test\":{\"type\":\"ArrowExpression\",\"params\":{\"type\":\"FormalParameters\",\"items\":[],\"rest\":null},\"body\":{\"type\":\"LiteralStringExpression\",\"value\":\"J$_pw_rIyB\"}},\"consequent\":[{\"type\":\"BreakStatement\",\"label\":\"null\"},{\"type\":\"ClassDeclaration\",\"name\":{\"type\":\"BindingIdentifier\",\"name\":\"ILp394S$N\"},\"super\":null,\"elements\":[]},{\"type\":\"ThrowStatement\",\"expression\":{\"type\":\"LiteralStringExpression\",\"value\":\"gaZ\"}}]},{\"type\":\"SwitchCase\",\"test\":{\"type\":\"CallExpression\",\"callee\":{\"type\":\"Super\"},\"arguments\":[]},\"consequent\":[{\"type\":\"WithStatement\",\"object\":{\"type\":\"LiteralStringExpression\",\"value\":\"hfe_\"},\"body\":{\"type\":\"DebuggerStatement\"}},{\"type\":\"WithStatement\",\"object\":{\"type\":\"LiteralStringExpression\",\"value\":\"il__BaT15\"},\"body\":{\"type\":\"DebuggerStatement\"}},{\"type\":\"SwitchStatement\",\"discriminant\":{\"type\":\"LiteralStringExpression\",\"value\":\"bnU2BdedDw_K\"},\"cases\":[]},{\"type\":\"VariableDeclarationStatement\",\"declaration\":{\"type\":\"VariableDeclaration\",\"kind\":\"var\",\"declarators\":[{\"type\":\"VariableDeclarator\",\"binding\":{\"type\":\"ArrayBinding\",\"elements\":[],\"restElement\":null},\"init\":{\"type\":\"LiteralStringExpression\",\"value\":\"zq\"}}]}}]}]},{\"type\":\"EmptyStatement\"},{\"type\":\"DebuggerStatement\"},{\"type\":\"EmptyStatement\"}]},\"name\":{\"type\":\"ComputedPropertyName\",\"expression\":{\"type\":\"LiteralStringExpression\",\"value\":\"OnLbltKWyYfAh\"}}}},{\"type\":\"ClassElement\",\"isStatic\":\"false\",\"method\":{\"type\":\"Getter\",\"body\":{\"type\":\"FunctionBody\",\"directives\":[],\"statements\":[{\"type\":\"EmptyStatement\"},{\"type\":\"LabeledStatement\",\"label\":\"xJmnhO7Mm\",\"body\":{\"type\":\"ForStatement\",\"init\":null,\"test\":null,\"update\":null,\"body\":{\"type\":\"EmptyStatement\"}}}]},\"name\":{\"type\":\"StaticPropertyName\",\"value\":\"fSZ_\"}}}]}]}", serialization2);

        Node randomAST3 = Fuzzer.generate(new Random(3), 10);
        String serialization3 = Serializer.serialize(randomAST3);
        assertEquals("{\"type\":\"Script\",\"directives\":[],\"statements\":[]}", serialization3);

        Node randomAST4 = Fuzzer.generate(new Random(4), 10);
        String serialization4 = Serializer.serialize(randomAST4);
        assertEquals("{\"type\":\"Script\",\"directives\":[{\"type\":\"Directive\",\"rawValue\":\"UyUR_GTv\"},{\"type\":\"Directive\",\"rawValue\":\"L4lPqdD$0QXXph\"}],\"statements\":[{\"type\":\"EmptyStatement\"},{\"type\":\"BlockStatement\",\"block\":{\"type\":\"Block\",\"statements\":[{\"type\":\"EmptyStatement\"}]}},{\"type\":\"EmptyStatement\"}]}", serialization4);

        Node randomAST5 = Fuzzer.generate(new Random(5), 10);
        String serialization5 = Serializer.serialize(randomAST5);
        assertEquals("{\"type\":\"Module\",\"directives\":[{\"type\":\"Directive\",\"rawValue\":\"B2sms2$AsxO9O\"},{\"type\":\"Directive\",\"rawValue\":\"gD6BYAzQUpuUZmB\"}],\"items\":[{\"type\":\"ExportAllFrom\",\"moduleSpecifier\":\"IcHatPZACuSr\"},{\"type\":\"ExportAllFrom\",\"moduleSpecifier\":\"gb\"}]}", serialization5);
    }
}
